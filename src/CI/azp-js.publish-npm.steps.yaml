steps:
- checkout: none

- download: current
  artifact: 'NPM package'
  # The destination path is $(Pipeline.Workspace)

- task: NodeTool@0
  displayName: 'Install Node.js 19.x'
  inputs:
    versionSpec: '19.x'

- task: ExtractFiles@1
  displayName: 'Extract Files'
  inputs:
    archiveFilePatterns: '$(Pipeline.Workspace)/NPM package/*.zip'
    destinationFolder: '$(System.DefaultWorkingDirectory)/unzipped'
    cleanDestinationFolder: true

- task: Npm@1
  displayName: 'Publish NPM (NodeJS)'
  inputs:
    command: 'publish'
    workingDir: '$(System.DefaultWorkingDirectory)/unzipped/dist/prepack/node'
    publishRegistry: 'useFeed'
    publishFeed: '06d72d2b-c76a-4d0a-be03-d2ba3a5a3f60/9a5bdfb1-0ab4-40b9-b9d2-de4cf6c011eb'

- task: Npm@1
  displayName: 'Publish NPM (Web)'
  inputs:
    command: 'publish'
    workingDir: '$(System.DefaultWorkingDirectory)/unzipped/dist/prepack/web'
    publishRegistry: 'useFeed'
    publishFeed: '06d72d2b-c76a-4d0a-be03-d2ba3a5a3f60/9a5bdfb1-0ab4-40b9-b9d2-de4cf6c011eb'
